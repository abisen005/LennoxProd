<apex:page sidebar="false" standardController="Opportunity" extensions="MergeTemplatesController"  showHeader="false" standardStylesheets="false" applyBodyTag="false" title="District Incentive Agreement" action="{!getData}"> 
    <apex:slds />
    <html>   
        <head>
            <apex:stylesheet value="{!URLFOR($Resource.toastr, 'toastr.min.css')}"/>
            <apex:stylesheet value="{!URLFOR($Resource.duallistbox, 'css/multi-select.css')}"/>
            <apex:includeScript value="{!$Resource.jquery}"/>    
            <apex:includeScript value="{!URLFOR($Resource.toastr, 'toastr.min.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.duallistbox, 'js/jquery.multi-select.js')}"/>
            
            
            <style>
       
                /* * {
                font-size: 10px;
                } */
                
                body {
                font-family: sans-serif;
                }
                
                .btnDiv {
                display: none;
                }
                
                .pdf-header-title,
                .header-yr-info span {
                font-size: 20px;
                font-weight: bold;
                }
                
                .container {
                max-width: 1300px;
                margin: 0 auto;
                padding: 20px;
                }
                
                .header-table {
                table-layout: fixed;
                width: 100%;
                }
                
                .header-yr-info {
                text-align: right;
                }
                
                .title-text {
                font-size: 18px;
                font-weight: 700;
                }
                
                .vspace {
                margin-top: 10px;
                margin-bottom: 10px;
                }
                
                .tableStyle tr th {
                background: #A80C35;
                color: #fff;
                padding: 8px 5px;
                font-size: 15px;
                -fs-table-paginate: paginate;
                }
                
                .tableStyle2 tr th {
                background: #f8eff3;
                color: #1d1b1b;
                padding: 8px 5px;
                font-size: 15px;
                }
                
                .tableStyle tr td {
                padding: 8px 5px;
                font-weight: bold;
                -fs-table-paginate: paginate;
                }
                
                .page-break {
                page-break-after: always;
                }
                
                .header {
                margin-bottom: 20px;
                margin-top: 15px;
                }
                
                .bigSpace {
                height: 30px;
                }
                
                h2.title-text>u {
                font-size: 14px;
                }
                
                ul.list-view {
                list-style-position: inside;
                }
                
                .footer {
                margin-top: 30px;
                }
                
                table.header-table tr td,
                table.footer-table tr td {
                padding: 8px 5px;
                }
                
                button {
                line-height: 25px;
                padding: 0 10px;
                border: 1px solid #ccc;
                }
                
                #ms-my-select {
                width: 100%;
                }
                
                #ms-my-select-user {
                width: 100%;
                }
                
                
                @media all {
                
                .container * {
                font-family: 'Open Sans', sans-serif !important;
                font-size: 13px;
                }
                
                .loader {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 100%;
                height: 100%;
                background: rgba(255, 255, 255, 0.8);
                }
                
                .bgBlack {
                position: fixed;
                top: 0;
                bottom: 0;
                left: 0;
                bottom: 0;
                z-index: 9002;
                width: 100%;
                height: 100%;
                }
                
                .pageBreak {
                display: none;
                }
                
                .signPdf {
                display: none;
                }
                
                .pdf-header-title,
                .header-yr-info span {
                font-size: 15px;
                font-weight: bold;
                }
                
                .btnDiv {
                display: block;
                }
                
                .pageBreak {
                display: none;
                }
                
                .signPdf {
                display: none;
                }
                
                .pull-right {
                float: left;
                margin-right: 15px;
                }
                }
                
                .hide {
                display: none;
                }
                
                @media print {
                
                .tableHead-break {
                display: table-header-group;
                }
                
                @page {
                
                margin: 20mm 7mm 20mm;
                
                @top-center {
                content: element(header);
                }
                
                @bottom-left {
                content: element(footer);
                }
                
                
                }
                
                table {
                page-break-inside: auto -fs-table-paginate: paginate;
                }
                
                * {
                font-size: 10px;
                }
                
                
                .container * {
                font-family: sans-serif !important;
                font-size: 10px !important;
                }
                
                h2.title-text>u,
                .title-text,
                .tableStyle tr th {
                -fs-table-paginate: paginate;
                font-size: 12px;
                }
                
                .tableStyle2 tr th {
                font-size: 12px;
                }
                
                .tableStyle tr th {
                border: 1px solid #ded8d8;
                -fs-table-paginate: paginate;
                }
                
                .pdf-header-title,
                .header-yr-info span {
                font-size: 15px;
                }
                
                img.logoDoc {
                display: block;
                width: 100px !important;
                }
                
                div.header {
                padding: 0px;
                position: running(header);
                }
                
                div.footer {
                display: block;
                padding: 0px;
                position: running(footer);
                }
                
                .pagenumber:before {
                content: counter(page);
                }
                
                .pagecount:before {
                content: counter(pages);
                }
                
                .page-break {
                display: block;
                page-break-after: always;
                }
                
                .table {
                fs-table-paginate: paginate;
                
                
                }
                
                .pagenumber:before {
                content: counter(page);
                }
                
                .pagecount:before {
                content: counter(pages);
                }
                
                .page-break {
                display: block;
                page-break-after: always;
                }
                
                .slds-modal,
                .print-btn,
                .slds-backdrop.slds-backdrop--open {
                display: none;
                }
                
                td {
                font-size: 10px;
                }
                
                }
                
                ul li {
                
                list-style-type: disc;
                
                text-align: left;
                
                }
                
                .alignleft {
                float: left;
                }
                
                .alignright {
                float: right;
                }
                
                .aligncenter {
                float: center;
                }
                
                .richTextFormat ol {
                display:inline-block;
                text-align: initial !important;
                }
                
                .richTextFormat ul {
                display:inline-block;
                text-align: initial !important;
                }
                .richTextFormat p { 
                text-align: center !important;
                
                }
                .richTextFormat li { 
                text-align: left !important;
                
                }
                
                
            </style>
        </head>      
        
        
        <body style="font-size:15px;">
            <div>
                <table width="100%" cellspacing="0" cellpadding="0" border="0" class="btnDiv" >
                    <tr>
                        <td>
                            <apex:form > 
                                <apex:pageBlock >
                                    <apex:pageMessages />
                                </apex:pageBlock>  
                                <apex:actionFunction name="sendDocusignNow" action="{!sendDocusignNow}" reRender="hrscreening,scriptpanel,signerlist" oncomplete="handleResponseAfterSend();return false;">
                                    <apex:param value="" name="contactIdLst"/>
                                </apex:actionFunction>
                                
                                <apex:actionFunction name="createDocumentAction" action="{!createDocument}" reRender="hrscreening,scriptpanel,signerlist" oncomplete="handleResponseAfterDocument();return false;">
                                    <apex:param value="" name="contactIdLst"/>
                                </apex:actionFunction>
                                
                                <apex:actionFunction name="sendViaDocusign" action="{!SetDealerSigner}" reRender="hrscreening,scriptpanel,signerlist" oncomplete="handleResponse();return false;">
                                    <apex:param value="" name="contactIdLst"/>
                                </apex:actionFunction>
                                <apex:outputPanel id="hrscreening"></apex:outputPanel>
                                
                                <apex:actionFunction name="getManageUser" action="{!getManagers}" reRender="manageUsers" oncomplete="initialize();return false;">
                                    <apex:param value="" name="contactId"/>
                                </apex:actionFunction> 
                                
                                <apex:actionFunction name="removeManageUser" action="{!removeManagers}" reRender="manageUsers" oncomplete="initialize();return false;">
                                    <apex:param value="" name="contactId"/>
                                </apex:actionFunction>  
                                
                                <apex:actionFunction name="getDealerSigners" action="{!getDealerSigners}" reRender="contactUserSection" oncomplete="sendDocument();return false;">
                                    <apex:param value="" name="contactIdLst"/>
                                    <apex:param value="" name="userIdLst"/>
                                </apex:actionFunction>
                                
                            </apex:form>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="print-btn" ><!---->
                             <!--   <button type="button" onclick="sendViaDocuSign(event);" class="docuSign">
                                    Select Dealer Contacts To Send via Docusign
                                </button> -->
                                <c:printPDF buttonClass="btn btn-small print pull-right"  accountId="{!Opportunity.AccountId}" name="Lennox Incentive Agreement" border="20px"/>
                            </div> 
                        </td>
                    </tr>
                </table>
                <div class="header" > 
                    <table class="header-table" cellspacing="0" cellpadding="8" width="100%" border="0" style="table-layout:fixed;">
                        <tr>
                            <td style="border-bottom:2px solid #8a8a8a;" width="150">
                                <div class="logo-image">
                                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPEAAABLCAMAAACWRJEoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRF////5pywyCBOwAE188/ZvQAr22+M0UZsUHFZ7gAABq5JREFUeNrsXO2CoyAMbGKA93/jExEJ+UDY7e11e+XXVhEZMglDhH08PuVTPuVTlgvtBQDiWZJXagWA/MQvRJkxpoSI27aF1bJtiHkMMvrXxllhroDc7MKxZ+SvhfMgaw8zdxpLEazl5C4Vto4GNvQDePzHJs8W3XE2W2CBBcUT5ztHzdU7ghjI99fEn7c3FajIne2ZY1+CACONAr6b+2eMfRiilh+Ip8XweWwl7vxzH2v66/H3X80aVN1HosYEv24eW4KtjH3Y+p1BH8Eyw+5tvRP8nUFn2MkADY//DvS7Yy6ge8z45uTeQUcUcWyLs3PO4rRD5lP8it2svELA11JMTJH1BuuVgILceMftdNVVkNEuuR6aTx1XcdBsyp3DeqVONlyMV1+MF4x0PR0LpCS6CUn689B41MZG3gJzUXPUa7cCN0G+GuL1Z6kA4mW1x5SsZVM461+IW7/KS3U/9zvCn7eRmVvLygGSjTh2tzig0hb1JuIVjj7XC7x5JitORGy4idsmbJYBSfQ1DLwZg0dqkgvVsxC/1QHCZsHWLH95IbUEfCwE85IxsBZJveF8wDGfNLPL7BlSh25hC70BGCBmQWIVkiB1FH4aqkikyFtEQb4C2Dce4RyzZ0gdyH2qe84kNUdchoSECSUHOoRXA9F1YscLA9Iiqa9bxlvQBMRIzV7OHs+PnT/tkQaGuHfkGrWGUTjNTFNGxxXflfUpbAYgTuoujJBBanukI4tsjAV0UfZGM0hiG9Wbr4LP9xGpWS9i42w3rwXSeCCYI50CaxBZ6LpzYseX04gH5I/XzVCS5mxHr2swGZ5kjnQ3XbM6cRKwkhAGPaci9YjUrc+Ms2S/tvk5bZaA6dxYMsm22ONOQ5ALK/qkhjGp66Meqa+egkVqfDhurO2FM8KfwniUBhPQ5UVGpDYbZaQW3oRKfqA90hj4+0iYeG7xK8UXPYHUYA4j19RCl6J0UrJZR6Efg27gJpzYNHJ8qvyIbLRM+REZrFlSk2muKSceMHAlUjOJSb0yScQePkgt5AcStkFjpLYjdYlsaCu7acCS1mgOx0B+dMuIXh/u3W0sIBZ0sDEHr8ud/DBJDYLUnfvMpyviIFrPRGodgbgyaYBMdQFMKMOt/JCkdrT36pQMq6RWQeC6hVz5W5zdmy0okic/opIfaPY9wHMQ+5GaZTB8UqdHA8TVEm+2WBa7yYvs3ihSO2vsb8iuKfkRZYatUyZQEZucjXXosJt5WpcG8kOsv9JTEI/kR/DlR1DprpPeQZP6QR29R6QW8kOEEnwGq7+pqY/uVkCWpi7P4on4VlOTlT14QqxmL/mmpi4tnfMtGJq6PFuiOdGiplZKFb46H2+0EqnDDakrIPBIXaM5WIpsSOpzfbgeushfcE3Ij9HykiejojF5cf0VopnlHGjqc1hwHbEfuAawwA9pMmdSEOOmk5hdot2scLtQvGTsSrBObuCKX8p+SFeIUgjG6QqC1HwMTjmOXI/OkjrckloHfprJ9qWHyjqbIYDpJlTZK09+lEYywwYz6OryeDABDSK1SgRKIUjSglIbMzdzSR1bVmvQl9XVcfKbmkhhX8QgoRHUBCAX/+k+iQnBGKBJR7azLzfyg8I8qdUV3aw1nQ2TmGR+bwv4FfUBT0vptVsXIHCarUZVCSEvM9/l4mlJdcVBxictMHeoTGpD6DV79YL8VQRfKJ7SA2RvJhx5YGGlE+bkx8P9uubID4bxvKK/Cl9fEjhLlBSZ0SDD7DxzP+ClJya/Q84nm2h+82UVgFfgC+9Ulp9EcbsW0b0Tr4UukUXfovs1lBUUH7JZAccVao/I+1RF/RW2yi+7r6t4Ltky9UFtEGJHmwRUOh/t/Q6gc83c6yxlQmYgRpU+RNsSod/9IZzYzwIqRuMYMDj79MlO6fHcnN7LYmTmde6mDVIyd7uUT73R+KCWJkIXxX5T1zaVqTx7he5YOPuV0NfUxhfSYg5nRxPJ3UxzoesMBMMtIGSX6VvOprX7XW11G1c9HnHswL92rdkb6ehmh13EhZ1Nv7+QcuD01hsz5fbbqU2Zv9i8xibU97XvLltQbkx8443GGa1g8/vuqz5OxIT/47xAPvMVreM/+H5nQs6TguYRL0bmY8I+tPlLmGf9WJg8x6eO8cnTi4D7hV3apfQSjGynrdshTqPUo5ruWc12RlWf6YK0K/9IW3opXyxmw804ezw6kdwOIif/NG5GnPJ4vWoYug5m3x3Nnj1snhHHiJBePjCJfzLQbV5fOeUL8XEka95aaH6KU/4IMAANyFtbKC3GxgAAAABJRU5ErkJggg==" width="135" height="45" />
                                </div> 
                            </td>
                            <td class="pdf-header-title" style="border-bottom:2px solid #8a8a8a; border-right:2px solid #8a8a8a;" align="center">Lennox Incentive Agreement</td>
                            <td class="header-yr-info" width="100" style="border-bottom:2px solid #8a8a8a; text-align:center;"><apex:outputText value="{0,date, yyyy}" style=" "> <apex:param value="{!NOW()}" /> </apex:outputText></td>
                        </tr>
                    </table>
                </div> 
                
                <div class="content">
                    <div class="account-info"> 
                        <p class="dateStyle"><apex:outputText value="{0,date, MM/dd/yyyy}" style=""> <apex:param value="{!NOW()}" /></apex:outputText></p>
                        <p style="">{!opportunity.Account.SAP_Customer_Number__c}</p>
                        <p style="">{!opportunity.Account.Name}</p>
                        <p style="">
                            {!opportunity.Account.ShippingStreet}<br/>
                            {!opportunity.Account.ShippingCity}, {!opportunity.Account.ShippingState} {!opportunity.Account.ShippingPostalCode}<br/>
                            {!opportunity.Account.ShippingCountry}<br/>
                        </p>
                    </div>
                    <!--<h2 class="title-text">2019 Market Leader Agreement:  «OPPORTUNITY_TYPE»</h2>-->
                    
                    <!--Display Proposal Type-->
                    <!-- <tr>
                        <b> <apex:outputField value="{!opportunity.Type}">:</apex:outputField></b>
                    </tr> -->
                    
                    
                    <apex:outputpanel rendered="{!IF((opportunity.Type == 'New Customer') ||  (opportunity.Type =='New Customer - District VR') ||( opportunity.Type =='New Customer - Rebate') || (opportunity.Type == 'New Customer - Full Force') , true ,false)}" > 
                        
                        <div class="paragraph vspace" style=""> 
                            Thank you for selecting Lennox products, we look forward to our partnership. Lennox
                            is offering the following Incentives based on your purchase agreement as follows:
                        </div>
                    </apex:outputpanel>
                    
                    <apex:outputpanel rendered="{!IF((opportunity.Type == 'Existing Dealer')  || (opportunity.Type =='Existing Customer - Lennox Partner Incentive') ||  (opportunity.Type =='Existing Dealer - VR') || (opportunity.Type == 'Existing Dealer - Full Force'), true ,false)}" > 
                        
                        <div class="paragraph vspace" style=""> 
                            Thank you for selecting Lennox products, we look forward to our continued partnership. Lennox
                            is offering the following Incentives based on your purchase agreement as follows:
                        </div>
                    </apex:outputpanel>
                    
                    <apex:outputpanel rendered="{!IF(opportunity.Type == 'Existing Dealer - Market Leader', true ,false)}" >
                        <div class="paragraph vspace" style=""> 
                            Thank you for purchasing&nbsp;<apex:outputText value="{0,number,$###,###,###,###}"> <apex:param value="{!opportunity.PY_Total_Sales__c}" /> </apex:outputText> of Lennox product last year. We look forward to working with you this year and in the future.  
                            Based on recent competitive activity we are pleased to extend the following Market Leader incentives.These incentives are offered for an agreed purchase goal of&nbsp;<apex:outputText value="{0,number,$###,###,###,###}"> <apex:param value="{!opportunity.Amount}"/> </apex:outputText>.  
                            The agreement will be reviewed on a quarterly basis. Lennox reserves the right to cancel this agreement.
                            <br/><br/>        
                            
                            <b>Market Leader Incentives Agreement Basis</b>
                            <ul >
                                <li>{!opportunity.Account.Name} agrees to keep their credit account current</li>
                                <li>Incentives may be available beyond the initial twelve month period of this program</li>
                                <li>Performance to the agreed purchase amounts will be evaluated quarterly</li>
                                <li>Market Leader Incentives are not available on equipment sold via Costco or Home Depot and Residential New Construction</li>
                                <li>Market leader start date is <apex:outputText value="{0, date, MMMM d','  yyyy}"><apex:param value="{!opportunity.Market_Leader_Load_Date__c}" /></apex:outputText>. Market leader end date is <apex:outputText value="{0, date, MMMM d','  yyyy}"><apex:param value="{!opportunity.ML_Expiration_Date__c}" /></apex:outputText></li>
                            </ul>
                            <b>Market Leader Rebates</b>
                            <ul >
                                <li> Lennox will pay rebates in the amount shown for the products indicated in the schedule below</li>
                                <li> Rebates will be paid monthly in the form of a lump sum credit to the dealers account</li>
                                <li> Rebates will be paid on products purchased at the price established for your account </li>
                                <li> Dealer must sign a Market Leader Rebate Agreement Form   </li>
                            </ul>
                            
                        </div>
                        
                    </apex:outputpanel>
                    
                    
                    <apex:outputpanel rendered="{!IF(opportunity.Type == 'New Customer - Lennox Partner Incentive', true ,false)}" >
                        <div class="paragraph vspace" style=""> 
                            Thank you for selecting Lennox products. We look forward to working with you this year and in the future.  Based on your  purchase agreement for&nbsp;<apex:outputText value="{0,number,$###,###,###,###}">
                            <apex:param value="{!opportunity.Amount}"/>
                            </apex:outputText>
                            in total annual residential purchases from Lennox, Lennox is offering the following partner incentives.  The term of this Lennox Partner Incentive Agreement 
                            (this “<b>Agreement</b>”) is effective from <apex:outputText value="{0, date, MMMM d','  yyyy}"><apex:param value="{!opportunity.Lennox_Partner_Incentive_Load_Date__c}" /></apex:outputText> through
                            <apex:outputText value="{0, date, MMMM d','  yyyy}"><apex:param value="{!opportunity.Lennox_Partner_Incentive_Expiration_Date__c}" /></apex:outputText> (the “<b>Agreement Time Period</b>”).  
                            *These dates follow the Lennox fiscal months.*  It does not automatically renew at the expiration of the Agreement Time Period; however, based on Dealer achieving 
                            its performance objectives, the parties may mutually agree to extend the Agreement Time Period for an additional twelve (12) months on written agreement of the parties. 
                            The parties will review this Agreement quarterly with representatives of both parties to monitor the progress on the performance objectives agreed upon.  
                               
                        </div>
                    </apex:outputpanel>
                     <br/> 
                    
                    <div class="paragraph vspace" style=""> 
                        <h2  style=" margin-bottom:15px;font-size: 13px;text-align:center">Agreement Purchase Amount</h2>
                       <h2  style=" margin-bottom:15px;font-size: 12px;text-decoration: underline;text-align:center">
                        <u style="font-weight:bold;font-size: 12px;" class="title-text"> 
                            <apex:outputText value="{0,number,$###,###,###,###}">
                                <apex:param value="{!opportunity.Amount}" />
                            </apex:outputText></u>
                        </h2>
                       
                    </div>
                               
                    

                    <apex:outputpanel rendered="{!if(AND(opportunity.NC_CAP_Consumer_Promotional_Program__c == true  && contains(opportunity.Type, 'New Customer')), true, false)}" >
                      
                            <h2  style=" margin-bottom:15px;font-size: 13px;text-align:center">CAP Promotional Period: &nbsp;&nbsp;
                           
                                <apex:outputText value="{!opportunity.Promotional_Periods_Requested__c}" ></apex:outputText>
                            </h2>   
                    </apex:outputpanel>
                   
                   
      
                        <apex:outputpanel rendered="{!IF(opportunity.Type == 'New Customer - Lennox Partner Incentive', true ,false)}" >
                              <div class="paragraph vspace" style=""> 
                            <ul>
                                <li>During the Agreement Time Period, Dealer will earn rebates in the amounts shown below for each listed 
                                    product tier for each product Dealer purchases from Lennox: 
                                </li>
                            </ul>
                             </div>
                        </apex:outputpanel>
                   
                  
          
                    
                    <!-- NC LPI Incentives -->
                    <apex:outputpanel rendered="{!if(AND(lpiIncentiveList.size > 0 ,lpiTotal > 0 ), true ,false)}" > 
                           
                        <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                            <tr>
                                <th colspan="3" style="background:#A80C35; border:1px solid #ddd;  color:#fff;text-align: center">Lennox Partner Incentives</th>
                            </tr>
                            
                            <tr> 
                                <td colspan="2" style="border:px solid #ddd;  width:70%;border-top:none; font-weight:bold;text-align: left;">Product Line</td>
                                <td colspan="1" style="border:px solid #ddd;  width:40%;border-top:none;font-weight:bold;text-align: right;">Rebates</td>
                            </tr>
                            <apex:repeat value="{!lpiIncentiveList}" var="lpi"> 
                                <tr> 
                                    <td colspan="2" style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;"> <apex:outputlabel >
                                        <apex:outputField style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;" value="{!lpi.Product_Line__c}"/></apex:outputlabel>
                                    </td>
                                    <td colspan="1" style="border:px solid #ddd;  width:30%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!lpi.LPI_New_Customer_Rebates__c + lpi.LPI_District_Rebates__c}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                            
                            <br/>
                            <!-- NC LPI Verbiage -->
                            
                            <apex:outputpanel rendered="{!if(ISBLANK(opportunity.Lennox_Partner_Incentives_Proposal_PDF__c), false, true)}" >
                                <tr>
                                    <td colspan="3" style="font: size 9px; text-align: center;border:3px solid #ddd; width:15%;font-weight: 600;">
                                        <apex:outputText styleClass="richTextFormat" value="{!opportunity.Lennox_Partner_Incentives_Proposal_PDF__c}" escape="false"/>
                                    </td>
                                </tr>
                            </apex:outputpanel>
                        </table>
                        <br/>  
                    </apex:outputpanel>
                    
                       
                    
                    <!-- New Customer Incentives  -->
                    
                    <apex:outputpanel rendered="{!if(AND(newCustomerIncentiveList.size > 0,newCustomerAllTotal > 0) , true ,false)}" > 
                        <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                            <tr>
                                <th colspan="3" style="background:#A80C35; border:1px solid #ddd;  color:#fff;text-align: center;">New Customer Incentives</th>
                            </tr>
                            <tr>
                                <td style="border:0px solid #ddd;  width:30%;border-top:none; font-weight:bold;text-align: left;">Funding Type</td>
                                <td style="border:0px solid #ddd;  width:70%;border-top:none;font-weight:bold;text-align: left;">Incentive Description</td>
                                <td style="border:0px solid #ddd;  width:25%;border-top:none;font-weight:bold;text-align: right;">Funding Amount</td>
                            </tr>
                            <apex:repeat value="{!newCustomerIncentiveList}" var="dfi"> 
                                <tr> 
                                    <td  style="border:0px solid #ddd;  width:30%;border-top:none;font-weight: 500;">{!dfi.Funding_Type__c}</td>
                                    <td  style="border:0px solid #ddd; width:70%;border-top:none;font-weight: 500;text-align: left;">{!dfi.Incentive_Description__c}</td>
                                    <td  style="border:0px solid #ddd;  width:25%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!dfi.Funding_Amount__c}"/>
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                            <br/>
                            <tr >  
                                <td colspan="2" style=" width:15%;font-weight: 600;"><b>Total New Customer Funding</b></td>
                                <td style="border:0px solid #ddd;  width:15%;font-weight: 600;text-align: right;">
                                    <apex:outputText value="{0,number,$#,###.##}">
                                        <!--<apex:param value="{!ncTotal}" />-->
                                        <apex:param value="{!newCustomerAllTotal}" />
                                    </apex:outputText>
                                </td>
                            </tr>
                       
                        <br/>
                        
                        <!-- NC Verbiage -->
                             <apex:outputpanel rendered="{!if(ISBLANK(opportunity.New_Customer_Proposal_Payout_Info__c) , false ,true)}" > 
                            <td class="edit-cell" style="display:{if(ISBLANK(opportunity.New_Customer_Proposal_Payout_Info__c), false, true)}" >
                                <tr style="display:{if(ISBLANK(opportunity.New_Customer_Proposal_Payout_Info__c), false, true)}">
                                    <td colspan="3" style="font: size 9px; text-align: center;border:3px solid #ddd; width:15%;font-weight: 600; display:{if(ISBLANK(opportunity.New_Customer_Proposal_Payout_Info__c), false, true)}">
                                        <apex:outputText styleClass="richTextFormat" value="{!opportunity.New_Customer_Proposal_Payout_Info__c}" escape="false"/>
                                    </td>
                                </tr>
                            </td>
                            </apex:outputpanel>
                             </table>                  
                    </apex:outputpanel>
                    
                    
                    
                    <!--New Customer Payout Plan Incentive -->
                    <apex:outputpanel rendered="{!if(AND(newCustomerPayoutPlanList.size > 0 , newCustomerPayoutIncentiveTotal > 0) , true ,false)}" > 
                        <table class="content-table tableStyle2" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                          
                            <tr>
                                <th colspan="4" style=" background:##f8eff3;font-color:#1d1b1b; ">New Customer Payout Plan Incentives</th>
                            </tr>
                            <tr>
                                <td style="border:px solid #ddd;  width:70%;border-top:none; font-weight:bold;text-align: left;">Type</td>
                                <td style="border:px solid #ddd;  width:70%;border-top:none; font-weight:bold;text-align: left;">Payout Level</td>
                                
                                <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight:bold;text-align: right;">Payout-Sales Threshold</td>
                                <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight:bold;text-align: right;">Payout Amount</td>
                            </tr>
                            <apex:repeat value="{!newCustomerPayoutPlanList}" var="d"> 
                                <tr> 
                                    <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">{!d.Type_of_Incentive__c}</td>
                                    <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">{!d.Payout_Type__c}</td>
                                    
                                    <td style="border:px solid #ddd; width:15%;border-top:none;font-weight: 500;text-align:right">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!d.Payout_Sales_Threshold__c}"/>
                                        </apex:outputText>
                                    </td>
                                    
                                    <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!d.Payout_Amount__c}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                            <br/>
                            
                            <tr >  
                                <td colspan="3" style="border:0px solid #ddd; width:15%;font-weight: 600;"><b>Total New Customer Payout Incentives</b></td>
                                <td style="border:0px solid #ddd;  width:15%;font-weight: 600;text-align: right;">
                                    <apex:outputText value="{0,number,$#,###.##}">
                                        <!--<apex:param value="{!ncTotal}" />-->
                                        <apex:param value="{!newCustomerPayoutIncentiveTotal}" />
                                    </apex:outputText>
                                </td>
                            </tr>  
                        </table>
                        <br/>
                    </apex:outputpanel>
                    
                    
                  
                    
                    <!-- Market Leader Incentives -->
                    <apex:outputpanel rendered="{!if(AND(marketLeaderIncentiveList.size > 0 ,marketLeaderTotal > 0), true ,false)}" > 
                        <div class="page-break"></div>
                        <table class="content-table tableStyle4 " cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded;">
                        <thead class="tableHead-break">
                               <tr>
                                <th colspan="3" style="background:#A80C35; border:1px solid #ddd;  color:#fff;">Market Leader Incentives</th>
                            </tr>
                            <tr>
                                <th style="border:px solid #ddd;  width:33%;border-top:none; font-weight:bold;text-align: left;">Market Leader Product</th>
                                <th style="border:px solid #ddd;  width:33%;border-top:none;font-weight:bold;text-align: left;">Payout Level</th>
                                <th style="border:px solid #ddd;  width:33%;border-top:none;font-weight:bold;text-align: right;">Payout Per Unit</th>
                            </tr>
                        </thead>
                                 <tbody>
                            <apex:repeat value="{!marketLeaderIncentiveList}" var="ml"> 
                        
                                <tr> 
                                    <td style="border:px solid #ddd;  width:33%;border-top:none;font-weight: 500;">{!ml.Market_Leader_Product__c}</td>
                                    <td style="border:px solid #ddd; width:33%;border-top:none;font-weight: 500;">{!ml.Payment_Type__c}</td>
                                    <td style="border:px solid #ddd;  width:33%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!ml.Rebate_per_Unit__c}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                            
                              
                            </apex:repeat>
                                       </tbody>
                           
                          <!--  <tr >  
                                <td colspan="2" style="border:px solid #ddd; width:15%;border-top:1;font-weight: 600;"><b>Total Market Leader Incentives</b></td>
                                <td style="border:px solid #ddd;  width:15%;border-top:1;font-weight: 600;text-align:right;">
                                    <apex:outputText value="{0,number,$#,###.##}">
                                        <apex:param value="{!marketLeaderTotal}" />
                                    </apex:outputText> 
                                </td>
                            </tr> -->
                      
                        
                        <!-- Market Leader Verbiage -->
                        
                            
                            <apex:outputpanel rendered="{!if(ISBLANK(opportunity.Market_Leader_Information__c), false, true)}" >
                                <tr>
                                    <td colspan="3" style="font: size 9px; text-align: center;border:3px solid #ddd; width:15%;font-weight: 600;">
                                        <apex:outputText styleClass="richTextFormat" value="{!opportunity.Market_Leader_Information__c}" escape="false"/>
                                    </td>
                                </tr>
                            </apex:outputpanel>
                                
                        </table> 
                      
                    </apex:outputpanel>
                    
                    
                    
                    <!-- District/Existing Customer Incentives -->
                    <apex:outputpanel rendered="{!if(AND(districtOnlyIncentiveList.size > 0 ,districtIncentiveTotal > 0) , true ,false)}" > 
                        <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                            <tr>
                                <th colspan="3" style="background:#A80C35; border:1px solid #ddd;  color:#fff;">District Incentives</th>
                            </tr>
                            <tr>
                                <td style="border:px solid #ddd;  width:30%;border-top:none; font-weight:bold;text-align: left;">Funding Type</td>
                                <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight:bold;text-align: left;">Incentive Description</td>
                                <td style="border:px solid #ddd;  width:25%;border-top:none;font-weight:bold;text-align: right;">Funding Amount</td>
                            </tr>
                            <apex:repeat value="{!districtOnlyIncentiveList}" var="dfi"> 
                                <tr> 
                                    <td style="border:px solid #ddd;  width:30%;border-top:none;font-weight: 500;">{!dfi.Funding_Type__c}</td>
                                    <td style="border:px solid #ddd; width:70%;border-top:none;font-weight: 500;">{!dfi.Incentive_Description__c}</td>
                                    <td style="border:px solid #ddd;  width:25%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!dfi.Funding_Amount__c}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                            <br/>
                            <tr >  
                                <td colspan="2" style="border:px solid #ddd; width:15%;border-top:1;font-weight: 600;"><b>Total District Incentives</b></td>
                                <td style="border:px solid #ddd;  width:15%;font-weight: 600;text-align:right;">
                                    <apex:outputText value="{0,number,$#,###.##}">
                                        <apex:param value="{!districtIncentiveTotal}" />
                                    </apex:outputText>
                                </td>
                            </tr>

                        <br/>
                        <!-- District Only Verbiage -->
                            
                            <apex:outputpanel rendered="{!if(ISBLANK(opportunity.District_Funds_Proposal_Payout_Info__c), false, true)}" >
                                <tr>
                                    <td colspan="3" style="font: size 9px; text-align:center;border:3px solid #ddd; width:15%;font-weight: 600;">
                                        <apex:outputText styleClass="richTextFormat" value="{!opportunity.District_Funds_Proposal_Payout_Info__c}" escape="false"/>
                                    </td>
                                </tr>
                            </apex:outputpanel>
                    
                            </table>
                       
                    </apex:outputpanel>
                    
                    
                    
                    <!--District Payout Plan Incentive -->
                    <apex:outputpanel rendered="{!if(AND(districtPayoutPlanList.size > 0, districtPayoutIncentiveTotal > 0 ) , true ,false)}" > 
                        <table class="content-table tableStyle2" cellspacing="0" cellpadding="8" width="100%" border=""  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                            <tr>
                                <th colspan="4" style="background:##f8eff3;font-color:#1d1b1b;  ">District Payout Plan Incentives</th>
                            </tr>
                            <tr>
                                <td style="border:0px solid #ddd;  width:70%;border-top:none; font-weight:bold;text-align: left;">Type</td>
                                <td style="border:px solid #ddd;  width:70%;border-top:none; font-weight:bold;text-align: left;">Payout Level</td>
                                <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight:bold;text-align: right;">Payout-Sales Threshold</td>
                                <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight:bold;text-align: right;">Payout Amount</td>
                                
                            </tr>
                            <apex:repeat value="{!districtPayoutPlanList}" var="d"> 
                                <tr> 
                                    <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">{!d.Type_of_Incentive__c}</td>
                                    <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">{!d.Payout_Type__c}</td>
                                    
                                    <td style="border:px solid #ddd; width:15%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!d.Payout_Sales_Threshold__c}" />
                                        </apex:outputText></td>
                                    <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">  <apex:param value="{!d.Payout_Amount__c}" /> </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                            <tr >  
                                <td colspan="3" style="border:px solid #ddd; width:15%;font-weight: 600;"><b>Total District Payout Incentives</b></td>
                                <td style="border:px solid #ddd;  width:15%;font-weight: 600;text-align: right;">
                                    <apex:outputText value="{0,number,$#,###.##}">
                                        <!--<apex:param value="{!ncTotal}" />-->
                                        <apex:param value="{!districtPayoutIncentiveTotal}" />
                                    </apex:outputText>
                                </td>
                            </tr>        
                        </table>
                       
                    </apex:outputpanel>
                    
                    <!-- District Verbiage -->
                    
                    
                   <!-- District Mktg Funds PDF Component Incentives  -->
                     <apex:outputpanel rendered="{!if(districtMktgFundsIncentiveList.size > 0  , true ,false)}" > 
                        <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                            <tr>
                                <th colspan="3" style="background:#A80C35; border:1px solid #ddd;  color:#fff;">District Marketing Funds</th>
                            </tr>
                            <tr>
                                <td style="border:px solid #ddd;  width:30%;border-top:none;font-weight:bold;text-align: left;">Product Line</td>
                                <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight:bold;text-align: center;">% of purchases</td>
                                <td style="border:px solid #ddd;  width:25%;border-top:none;font-weight:bold;text-align: right;">District Marketing Funds Earned</td>
                                
                            </tr>
                            <apex:repeat value="{!districtMktgFundsIncentiveList}" var="dfi"> 
                                <tr> 
                                    <td style="border:px solid #ddd;  width:30%;border-top:none;font-weight: 500;">{!dfi.Product_Line__c}</td>
                                   
                                    <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;text-align: center;">{!dfi.of_purchases__c}</td>
                                     <td style="border:px solid #ddd; width:25%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!dfi.District_Marketing_Funds_Earned__c}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                            <tr >  
                                <td colspan="2" style="border:0px solid #ddd; width:15%;font-weight: 600;"><b>Total District Marketing Funds Earned</b></td>
                                <td style="border:px solid #ddd;  width:15%;font-weight: 600;text-align:right;">
                                    <apex:outputText value="{0,number,$#,###.##}">
                                        <apex:param value="{!districtMktgFundsIncentiveTotal}" />
                                    </apex:outputText>
                                </td>
                            </tr>
                        
                        <br/>
                        <!-- District Marketing Funds Verbiage -->
                            
                            <apex:outputpanel rendered="{!if(ISBLANK(opportunity.District_Mktg_Funds_Proposal_PDF__c), false, true)}" >
                                <tr>
                                <td colspan="3" style="font: size 9px; text-align: center;border:3px solid #ddd; width:15%;font-weight: 600;">
                                    <apex:outputText styleClass="richTextFormat" value="{!opportunity.District_Mktg_Funds_Proposal_PDF__c}" escape="false"/>
                                    </td></tr> 
                            </apex:outputpanel>
                            </table>
                                             
                    </apex:outputpanel>
                    
                    
                    
                    
                    <!-- Special Incentives Component   -->
                    <apex:outputpanel rendered="{!if(AND(specialIncentiveList.size > 0,specialIncentivesTotal > 0 ), true ,false)}" > 
                        <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                            <tr>
                                <th colspan="3" style="background:#A80C35; border:1px solid #ddd;  color:#fff;">Special Incentives</th>
                            </tr>
                            <tr>
                                <td style="border:px solid #ddd;  width:30%;border-top:none; font-weight:bold;text-align: left;">Funding Type</td>
                                <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight:bold;text-align: left;">Incentive Description</td>
                                <td style="border:px solid #ddd;  width:25%;border-top:none;font-weight:bold;text-align: right;">Funding Amount</td>                            
                            </tr>
                            <apex:repeat value="{!specialIncentiveList}" var="spcl"> 
                                <tr> 
                                    <td style="border:px solid #ddd;  width:30%;border-top:none;font-weight: 500;">{!spcl.Funding_Type__c}</td>
                                    <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">{!spcl.Incentive_Description__c}</td>
                                    <td style="border:px solid #ddd; width:25%;border-top:none;font-weight: 500;text-align:right;">
                                        <apex:outputText value="{0,number,$#,###.##}">
                                            <apex:param value="{!spcl.Funding_Amount__c}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                            <tr >  
                                <td colspan="2" style="border:3px solid #ddd; width:15%;fborder-top:1ont-weight: 600;"><b>Total Special Marketing Funds Earned</b></td>
                                <td style="border:px solid #ddd;  width:15%;font-weight: 600;text-align:right;">
                                    <apex:outputText value="{0,number,$#,###.##}">
                                        <apex:param value="{!specialIncentivesTotal}" />
                                    </apex:outputText>
                                </td>
                            </tr>
                       
                        <br/>
                        
                        <!--Special Incentives Verbiage -->
                            
                            <apex:outputpanel rendered="{!if(ISBLANK(opportunity.Special_Incentives_PDF__c), false, true)}" >
                                <td colspan="3" style="font: size 9px; text-align: center;border:3px solid #ddd; width:15%;font-weight: 600;">
                                    <apex:outputText styleClass="richTextFormat" value="{!opportunity.Special_Incentives_PDF__c}" escape="false"/>
                                </td>
                            </apex:outputpanel>
                            
                   
                            </table>
                        <br/>                        <br/>
                    </apex:outputpanel>
                    
                    
                    <!-- District Marketing Matrix:  -->
                    <apex:outputpanel rendered="{!if(districtMktgFundsMatrixList.size > 0, true ,false)}" >
                        <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border:8px solid#f4eded; table-layout:fixed;page-break-inside:avoid;">
                            <tr>
                                <th colspan="3" style="background:#A80C35; border:1px solid #ddd;  color:#fff;">District Marketing Matrix</th>
                            </tr>
                            <tr>
                                <td style="border:px solid #ddd;  width:70%;border-top:none; font-weight:bold;text-align: center;"></td>
                                <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight:bold;text-align: center;">District Marketing Funds (%) </td>
                                <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight:bold;text-align: right;"> Potential Marketing Funds ($)  </td>
                            </tr>
                            <body>
                            <apex:repeat value="{!districtMktgFundsMatrixList}" var="matrix"> 
                                <apex:outputpanel rendered="{!if(matrix.District_Marketing_Funds_on_DLSC_Prod__c > 0 , true ,false)}" > 
                                    <tr> 
                                        <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">
                                            Dave Lennox Signature Collection Products
                                        </td>
                                        <td style="border:0px solid #ddd; width:15%;border-top:none;font-weight: 500;text-align:center;">
                                            <apex:outputText value="{0, number,###.0} %">
                                                <apex:param value="{!matrix.District_Marketing_Funds_on_DLSC_Prod__c}"/>
                                            </apex:outputText>
                                            
                                        </td>
                                        
                                        <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:right;">
                                            <apex:outputText value="{0,number,$#,###.##}">
                                                <apex:param value="{!matrix.District_Marketing_Funds_Earned_DLSC__c}" />
                                            </apex:outputText>     
                                        </td>
                                    </tr>
                                </apex:outputpanel>
                                <apex:variable var="v" value="1" rendered="{!if(matrix.District_Marketing_Funds_on_Elite_Prod__c >  0, true ,false)}" >
                                    <tr> 
                                        <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">
                                            Elite Products
                                        </td>
                                        <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:center;">
                                            <apex:outputText value="{0, number,###.0} %">
                                                <apex:param value="{!matrix.District_Marketing_Funds_on_Elite_Prod__c}"/>
                                            </apex:outputText>
                                            
                                        </td>
                                        <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:right;">
                                            <apex:outputText value="{0,number,$#,###.##}">
                                                <apex:param value="{!matrix.District_Marketing_Funds_Earned_Elite__c}"/>
                                            </apex:outputText>   
                                        </td>   
                                    </tr>
                                </apex:variable>
                                <apex:outputpanel rendered="{!if(AND(NOT(ISBLANK(matrix.District_Marketing_Funds_on_Merit_Prod__c)),matrix.District_Marketing_Funds_on_Merit_Prod__c > 0) , true ,false)}" >                                
                                    <tr> 
                                        <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">
                                            Merit Products
                                        </td>
                                        <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:center;">
                                            <apex:outputText value="{0, number,###.0} %">
                                                <apex:param value="{!matrix.District_Marketing_Funds_on_Merit_Prod__c}"/>
                                            </apex:outputText>
                                            
                                        </td>
                                        <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:right;">
                                            <apex:outputText value="{0,number,$#,###.##}">
                                                <apex:param value="{!matrix.District_Marketing_Funds_Earned_Merit__c}" />
                                            </apex:outputText>  
                                            
                                        </td>
                                    </tr>
                                </apex:outputpanel>
                                <apex:outputpanel rendered="{!if(AND(NOT(ISBLANK(matrix.District_Marketing_Funds_on_P_S__c)),matrix.District_Marketing_Funds_on_P_S__c > 0) , true ,false)}" >    
                                    
                                    <tr> 
                                        <td style="border:px solid #ddd;  width:70%;border-top:none;font-weight: 500;">
                                            Parts and Supplies
                                        </td>
                                        <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:center;">
                                            <apex:outputText value="{0, number,###.0} %">
                                                <apex:param value="{!matrix.District_Marketing_Funds_on_P_S__c}"/>
                                            </apex:outputText>
                                            
                                        </td>
                                        <td style="border:px solid #ddd;  width:15%;border-top:none;font-weight: 500;text-align:right;">
                                            <apex:outputText value="{0,number,$#,###.##}">
                                                <apex:param value="{!matrix.District_Marketing_Funds_Earned_P_S__c}" />
                                            </apex:outputText> 
                                        </td> 
                                    </tr>
                                </apex:outputpanel>   
                            </apex:repeat>
                            </body>
                          
                        <!-- District Marketing Matrix Verbiage -->
                        
                            <apex:outputpanel rendered="{!if(ISBLANK(opportunity.District_Mktg_Funds_Proposal_PDF__c), false, true)}" >
                                <tr>                                    
                                    <td class="slds-text-longform tile__title red-txt" colspan="3" style="font: size 9px; text-align:center;border:3px solid #ddd; width:15%;font-weight: 600;">
                                        <apex:outputText styleClass="richTextFormat" value="{!opportunity.District_Mktg_Funds_Proposal_PDF__c}" escape="false"/>
                                    </td>
                                </tr>
                            </apex:outputpanel>    
                         
                            </table>
                        <br/>                        <br/> <br/>
                    </apex:outputpanel>
                    
                    
                    
                    <!-- TOTAL INCENTIVES -->
                      <apex:outputpanel rendered="{!if(totalOfAllIncentives > 0, true ,false)}" >
                    <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border-collapse:collapse; table-layout:fixed;page-break-inside:avoid;">
                        <tr>
                            <th colspan="3" style="background:#A80C35; border:px solid #ddd;  color:#fff;font-size:15px">Total Incentives</th>
                        </tr>
                        <tr>                                    
                            <td colspan="3" style="text-align: center;border:3px solid #ddd; width:15%;font-weight: 600;text-align:center;">
                                <apex:outputText value="{0,number,$#,###.##}">
                                    <apex:param value="{!totalOfAllIncentives}" />
                                </apex:outputText>
                            </td>
                        </tr>                            
                    </table> 
                    </apex:outputpanel>
                    <br/>
                    
                    
                    
                    
                </div>
                <br/>
                <apex:outputpanel rendered="{!IF(opportunity.Type !='Existing Dealer - Market Leader',true,false)}">
                    <center><span style="font-size:16px;text-decoration: underline;">Incentives Agreement Basis </span> </center>
                    <div style="margin-left:15%;">
                       

                        <li>{!opportunity.Account.Name} agrees to keep their credit account current</li>
                        <li>Performance to the agreed purchase amounts will be evaluated quarterly</li>



 <apex:outputText rendered="{!IF((opportunity.Type =='New Customer')  || (opportunity.Type =='New Customer - Full Force') ||        
                                                    (opportunity.Type =='Market Leader - New Customer') || (opportunity.Type =='New Customer - Growth') ||
                                                    (opportunity.Type =='New Customer - District VR') || (opportunity.Type =='New Customer - Rebate'), true ,false)}" > <li>This agreement is valid 12 calendar months from date of signature</li> </apex:outputText>
                                                    
                                                      <apex:outputText rendered="{!IF(
                                                    (opportunity.Type =='New Customer - Lennox Partner Incentive') , true ,false)}" > <li>All incentives not related to, “Lennox Partner Incentives” will be valid for 12 months from the date of signature.</li> </apex:outputText>
                       
                        <!-- <apex:outputpanel rendered="{!IF(NOT(opportunity.Type =='New Customer'|| opportunity.Type =='New Customer - VR'|| opportunity.Type =='New Customer - Rebate'|| opportunity.Type =='Existing Customer - Lennox Partner Incentive'), true ,false)}" > 
<li>This document will expire within 7 business days if not returned with signature</li>
</apex:outputpanel>-->
                        <apex:outputText rendered="{!IF(contains(opportunity.Type , 'Existing Customer') || contains(opportunity.Type , 'Existing Dealer')  ,true,false)}">
                            <li>This document will terminate on <apex:outputText value="{0, date, MMMM d','  yyyy}"><apex:param value="{!opportunity.Expiration_Date__c}" /></apex:outputText></li>
                        </apex:outputText>
                    </div> 
                </apex:outputpanel>
                <br/>
                <br/>
                
                <apex:outputpanel rendered="{!IF(opportunity.Type == 'New Customer - Lennox Partner Incentive', true ,false)}" >
                    <ul >
                        <li>The following purchases do not count toward the rebate:  Residential New Construction purchases and/or 
                            business done through Home Depot, Costco or any other retail program.  The rebate will be given in the 
                            form of a monthly lump sum credit memo to Dealer’s account based on the purchases made in the previous month 
                            by Dealer and may be forfeited if Dealer’s account balance is not current pursuant to the customer records of 
                            Lennox at any time during the Agreement Time Period.  </li>
                        <li>Rebates will be paid on products purchased from Lennox at the price established for Dealer’s account pursuant to 
                            Lennox’s standard Terms and Conditions of Sale. </li>
                        <li>Dealer must sign this Agreement to qualify for the rebates hereunder.</li>
                    </ul>
                    <c><b>General Terms and Conditions</b></c>
                    <ul >
                        <li> Lennox and Dealer each has the right to terminate this Agreement upon thirty (30) days written notice to the other party.  
                            Notwithstanding the foregoing, upon termination, Lennox will pay all undisputed rebates earned hereunder and owed to Dealer under this Agreement.</li>
                        <li> This Agreement is governed by and construed in accordance with the laws of the State of Texas.  Any litigation filed and related to the subject matter of this Agreement will be filed in a court having jurisdiction located in Dallas, Texas.  In no event will Lennox be liable to Dealer hereunder for loss of profits, loss of use, indirect, incidental, consequential, punitive or special damages, whether or not foreseeable. Dealer will hold all confidential information that it obtains from Lennox in confidence, including the terms of this Agreement.  The parties may not assign this Agreement without the express written consent of the other party, and any assignment in violation of this provision is null and void.  The parties do not intend to create, and have not created by this Agreement, any partnership, joint venture, master servant, employer-employee or similar business relationship.  This Agreement shall be deemed to have been jointly drafted by all parties.  If any provision of this Agreement shall be held by a court of competent jurisdiction to be illegal, invalid or unenforceable, the remaining provisions shall 
                            remain in full force and effect, and the illegal, invalid or unenforceable parts shall be severed therefrom.  This Agreement may be executed in two or more counterparts, each of which shall be an original and all of which together shall constitute one and the same instrument.  This Agreement may be executed using electronically scanned signatures, and such signatures shall be given the authority of original signatures for purposes of executing and enforcing the validity of this Agreement.</li>    
                    </ul>
                </apex:outputpanel>
                
                
                <apex:outputpanel id="signerlist" >
                    <table class="content-table tableStyle" cellspacing="0" cellpadding="8" width="100%" border="0"  style="border-collapse:collapse; table-layout:fixed;page-break-inside:avoid;">
                        <tr>
                            <td style="background:#A80C35; border:1px solid #ddd;  color:#fff;width:5%;">Sr. No</td>
                            <td style="background:#A80C35; border:1px solid #ddd;  color:#fff;width:40%;">Signer</td>
                            <td style="background:#A80C35; border:1px solid #ddd;  color:#fff;width:30%;">Signatures</td>
                            <td style="background:#A80C35; border:1px solid #ddd;  color:#fff;width:25%;">Sign Date</td>
                        </tr>
                        <apex:variable value="{!1}" var="rowNum"/>
                        <apex:repeat value="{!userList}" var="userName" id="signerlist1111">
                            <tr> 
                                <td style="text-align:center;border:1px solid #ddd;  width:5%;border-top:none; font-weight:bold;">
                                    {!FLOOR(rowNum)})
                                </td>
                                <td style="border:1px solid #ddd;  width:40%;border-top:none; font-weight:bold;">
                                    {!userName}
                                </td>
                                <td style="border:1px solid #ddd;  width:30%;border-top:none;font-weight:bold;">
                                    
                                </td>
                                <td style="border:1px solid #ddd;  width:25%;border-top:none;font-weight:bold;">
                                </td>
                            </tr>
                            <apex:variable var="rowNum" value="{!rowNum + 1}"/>
                        </apex:repeat>
                    </table>
                </apex:outputpanel>
                
                <div class="footer">
                        <table class="footer-table" cellspacing="0" cellpadding="0" width="100%" border="0">
                            <tr>
                                <td class="page-number" style="border-top:2px solid #8a8a8a; border-right:2px solid #8a8a8a;" width="80"></td>
                                <td class="footer-text" style="border-top:2px solid #8a8a8a; ">
                                    CONFIDENTIALITY NOTICE: This agreement is considered confidential and privileged 
                                    information for the use of the designated recipient only.  Additional review, distribution, 
                                    or copying of it or its contents beyond the designated recipient is prohibited. 
                                    
                                </td>
                            </tr>
                        </table>            
                    </div> 
                
                <table width="100%" cellspacing="0" cellpadding="0" border="0" class="btnDiv1" >
                    
                    <tr>
                        <td align="center">
                            <div class="print-btn" style='margin-top:20px;margin-bottom:20px;'>
                                <center>
                                    <button style="background: blue;color: white;font-weight: 900;height: 37px;font-size: 18px;cursor:pointer" 
                                            type="button" onclick="createDocument();" class="docuSign" id='btn-send-now' >
                                        Send via Docusign
                                    </button>
                                </center>
                                
                            </div> 
                        </td>
                    </tr>
                </table>
                <br/>
                <div class="bgBlack" id="loader" style="display:none;">
                    <div class="loader"><img src="{!$Resource.spinnerBrand}" width="55" /></div>
                </div>
                
                
                <div id="docusignmodal" style="display:none;">
                    <div class="slds-scope" >
                        <section role="dialog" tabindex="-1" style="height:600px;" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                            <div class="slds-modal__container">
                                <header class="slds-modal__header">
                                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close"  onclick="hideDocusignModal();">
                                        <span aria-hidden="true">X</span>
                                        
                                        <span class="slds-assistive-text">Close</span>
                                    </button>
                                    <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">Select Signers</h2>
                                </header>
                                
                                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                    <div id='contact-section'>
                                        <center><h2 >Dealer Contacts</h2></center><br/>
                                        <select multiple="multiple" id="my-select" name="my-select[]">
                                            <apex:repeat value="{!account.Contacts}" var="contact">
                                                <option value='{!contact}'>{!contact.Name}</option>
                                            </apex:repeat>
                                        </select>
                                        
                                    </div>
                                    <div class="hide" id='manager-section111'>
                                        <center><h2 >Lennox Signers</h2></center><br/>
                                        <apex:outputPanel id="manageUsers">
                                            <select multiple="multiple" id="my-select-user" name="my-select-user[]">
                                                <apex:repeat value="{!idToUserMap}" var="user">
                                                    <option value='{!idToUserMap[user].Id}'>{!idToUserMap[user].FirstName} {!idToUserMap[user].LastName}</option>  
                                                </apex:repeat>  
                                            </select>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                                
                                <footer class="slds-modal__footer">
                                    <button class="slds-button slds-button_neutral" onclick="hideDocusignModal();">Cancel</button>
                                    <!--<button class="hide slds-button slds-button_brand " id='btn-next' onclick="next();">Next</button>
<button class="hide slds-button slds-button_brand " id='btn-back' onclick="back();">Back</button> -->
                                    <button class="hide1 slds-button slds-button_brand " id='btn-send' onclick="SetDealerSigner()">Set Dealer Signer</button>
                                </footer> 
                            </div>
                        </section>
                        <div class="slds-backdrop slds-backdrop_open"></div>
                        
                        
                    </div>
                </div>
                
                
            </div>
            
            
            
        </body>
        <script>
        document.title = "Incentive Agreement";
        </script>
        <script>
        //$('#btn-send').hide();
        //$('#btn-back').hide();
        function next(){
            $('#manager-section').removeClass('hide');
            $('#contact-section').addClass('hide');
            $('#btn-next').hide();
            $('#btn-send').show();
            $('#btn-back').show();
        }
        function back(){
            $('#manager-section').addClass('hide');
            $('#contact-section').removeClass('hide');
            $('#btn-next').show();
            $('#btn-send').hide();
            $('#btn-back').hide();
        }
        toastr.options={
            positionClass:'toast-top-center',
            preventDuplicates:true,
            closeDuration:3000  
        };
        function sendViaDocuSign(event){
            event.preventDefault();
            event.stopPropagation();
            //showSpinner();
            //console.log('button clicked');
            //sendViaDocusign();
            showDocusignModal();
        }
        
        function hideSpinner()
        {
            console.log('Hide spinnner');
            var x = document.getElementById('loader');
            x.style.display = 'none';
        }
        function showDocusignModal()
        {
            console.log('show spinnner');
            var x = document.getElementById('docusignmodal');
            x.style.display = 'block';
        }
        
        function hideDocusignModal()
        {
            console.log('Hide spinnner');
            var x = document.getElementById('docusignmodal');
            x.style.display = 'none';
        }
        function showSpinner()
        {
            console.log('show spinnner');
            var x = document.getElementById('loader');
            x.style.display = 'block';
        }
        
        setTimeout(function(){
            hideSpinner();
        },2000);
        
        
        
        function initialize(){
            hideSpinner();
            // var arraytest ='{!signerContactIdLst}' ;
            $('#my-select-user').multiSelect({
                afterSelect: function(values){ 
                    selectedUsers.push(values[0]);
                    console.log('selectedUsers add',selectedUsers);
                    //console.log('{!signerContactIdLst}',arraytest);
                },
                afterDeselect: function(values){
                    selectedUsers.splice(selectedUsers.indexOf(values[0]), 1);
                    console.log('selectedUsers delete',selectedUsers);
                },
                keepOrder: true
            });
        }
        var selectedContacts = [];
        var selectedUsers = [];
        var account = '{!account}';
        var contacts = '{!account.Contacts}';
        
        
        $('#my-select-user').multiSelect({
            afterSelect: function(values){ 
                selectedUsers.push(values[0]);
                console.log('selectedUsers add',selectedUsers);
            },
            afterDeselect: function(values){
                selectedUsers.splice(selectedUsers.indexOf(values[0]), 1);
                console.log('selectedUsers delete',selectedUsers);
            },
            keepOrder: true
        });
        $('#my-select').multiSelect({
            afterSelect: function(values){
                selectedContacts.push(values[0]);
                getManageUser(values[0]); 
                showSpinner();
                console.log('selectedContacts add',selectedContacts);
            },
            afterDeselect: function(values){
                removeManageUser(values[0]);
                selectedContacts.splice(selectedContacts.indexOf(values[0]), 1);
                showSpinner();
                console.log('selectedContacts delete',selectedContacts);
            },
            keepOrder: true
        });
        
        
        /*function setContactIdLst(){
            setContactLst(JSON.stringify(selectedContacts));
        }*/
        function SetDealerSigner(){
            showSpinner();
            //alert('get Delear');
            getDealerSigners(JSON.stringify(selectedContacts),JSON.stringify(selectedUsers));
        } 
        
        function sendDocument(){ 
            hideSpinner();            
            $('#docusignmodal').hide();
            //alert('Got Delear');
            showSpinner();
            //setContactIdLst(JSON.stringify(selectedContacts));
            
            sendViaDocusign(JSON.stringify(selectedContacts));
        }
        function createDocument(){ 
            showSpinner();
            createDocumentAction(JSON.stringify(selectedContacts));
            
           
            console.log('-- createDocument--'+JSON.stringify(selectedContacts));
            //console.log('-- createDocument--'+JSON.stringify(str));
        }
        function sendViaDocuSignSendNow(){ 
            showSpinner();
            sendDocusignNow(); 
        }
        
        
        </script>
    </html>
    <apex:outputpanel id="scriptpanel" >
        <script>
        function handleResponse(){
            hideSpinner();
            if('{!isError}' == 'true'){
                toastr.error('{!errorMsg}');
            }else{
                hideDocusignModal();
                $('#btn-send-now').focus();
            } 
        }
        
        function handleResponseAfterSend(){
            console.log('-- handleResponseAfterSend--');
            hideSpinner();
            if('{!isError}' == 'true'){
                toastr.error('{!errorMsg}');
            }else{
                hideDocusignModal();
                toastr.success('Docusign email sent.');
            } 
        }
        function handleResponseAfterDocument(){
            console.log('-- handleResponseAfterDocument--');
            if('{!isError}' == 'true'){
                hideSpinner();
                toastr.error('{!errorMsg}');
            }else{
                console.log('==sendViaDocuSignSendNow==>');
                sendViaDocuSignSendNow();
            } 
        }
        </script>
    </apex:outputpanel>
    <script>
    //showDocusignModal();
</script>
    
</apex:page>